# 淘宝买家订单数据导出

## 简介

- “淘宝买家订单数据导出”最初基于“淘宝买家订单导出-颜色分类”添加了“商品主图”，修改和修复了一些细节问题，当前版本与之前已经有了较大的变动。导出的项目包括下单日期、订单编号、子订单编号、店铺名称、商品名称、快照商品名称、商品颜色分类名称、商品主图链接、商品链接、商品交易快照链接、单价、数量、商品退款状态、订单实付款、订单交易状态、订单详情链接。并支持添加额外的下单日期时间、快递物流公司、快递物流单号信息。导出的订单数据为CSV文件。在导出淘宝买家订单数据时，支持一些可选功能，如商品名称和店铺名称黑名单关键词过滤，快照商品名称获取以及获取时的随机延时，Excel 数据格式适配，订单详情链接一致化。支持项目标题次序自定义，支持图片链接尺寸选择，支持项目标题和黑名单列表的数据的本地存储。使用的过程中会有反馈，如按钮的可用状态和颜色变化，以及窗口右下角的气泡通知等。
  ![淘宝买家订单数据导出界面](https://img.skyseeker.eu.org/2025/Image_2025-02-14_01-01-61.jpg)

## 安装

1. 安装对应浏览器的脚本管理器
   - Chrome：[Tampermonkey](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
   - Firefox：[Tampermonkey](https://addons.mozilla.org/firefox/addon/tampermonkey/)
   - Safari：[Tampermonkey](http://tampermonkey.net/?browser=safari)
   - Microsoft Edge：[Tampermonkey](https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd)

2. 在 **Greasy Fork** 搜索并安装此脚本。或者在 **github** 下载本项目的 zip 文件，解压后将压缩包中的 js 文件导入到浏览器的 **Tempermonkey** 扩展中。

## 使用

1. 登录 [淘宝](https://www.taobao.com/) 网页版，点击 **我的淘宝** -> **已买到的宝贝** 查看所有订单。

2. 页面顶部会出现用于图片尺寸链接选择的单选框和下拉列表，和用于项目标题排序和添加自定义项目标题的文本框，以及可选功能复选框和功能按钮。

3. 设置导出的订单项目标题，设置商品名称和店铺名称黑名单过滤关键词，选择所需的图片尺寸链接，勾选所需的可选功能。

4. 点击 **添加本页订单** 按钮，将当前页的订单数据添加到待导出的订单数据中。

5. 点击 **下一页** 按钮，点击 **添加本页订单** 按钮以继续添加订单列表数据。

6. 重复第 4 步直到最后一页，点击 **添加订单详情** 按钮以添加订单详情数据。

7. 点击 **导出订单数据** 按钮即可导出所有的订单数据为 CSV 文件。

## 使用说明

- **黑名单过滤** : 勾选 *黑名单过滤* 前的复选框启用此功能。**此功能可以过滤包含指定关键词的商品名称和店铺名称**。在 *黑名单关键词* 下的文本框中输入商品名称和店铺名称黑名单过滤关键词（每行一条），输入的黑名单关键词在点击其它空白处后生效。黑名单过滤的默认关键词为 *保险服务* 、 *增值服务* 、 *买家秀* 等，点击 **重置黑名单列表** 可恢复黑名单关键词为默认关键词。

- **快照名称获取** : 勾选 *快照名称获取* 前的复选框启用此功能。淘宝订单页面显示的商品名称并不完整，启用此功能后可以通过交易快照获取完整的商品名称。但是 **此功能需要花费一些时间，同时可能导致出现滑块验证，非必要不建议启用！**

- **数据获取延时** : 勾选 *数据获取延时* 前的复选框启用此功能。启用此功能后会在获取交易快照和订单详情时进行随机延时，以降低获取数据的频率。每获取一条数据后会随机延时1.0~3.0S后再获取下一条数据，以降低出现人机验证的可能性。

- **Excel 格式适配** : 勾选 *Excel 格式适配* 前的复选框启用此功能。启用此功能后会对 Excel 进行数据格式适配。在订单编号、子订单编号和物流单号后追加一个制表符，并使用 *"* 包裹数据和制表符，此方式可以避免使用 Excel 打开或直接导入 CSV 文件时数字以科学计数法显示。

- **链接一致化** : 勾选 *链接一致化* 前的复选框启用此功能。启用此功能后可以使现在和过去导出的文件中的订单详情链接保持一致。最近和过去下单的淘宝和天猫的订单的订单详情链接并不相同，此功能可以将订单详情链接转换为现在下单的淘宝订单详情链接。

- **项目次序自定义** : 更改项目标题的排列顺序即可实现项目次序自定义。在 *项目标题* 下的文本框中输入项目标题（每行一条），输入的项目标题在点击其它空白处后生效。默认的项目标题名称不能更改，但能增加用于占位的自定义项目标题。点击 **重置项目标题** 可恢复项目标题为默认的项目标题和项目排序。

- **数据本地存储** : 点击 **写入本地存储** 按钮后，当前的 *项目标题* 和 *黑名单列表* 会被存储到本地。存储的数据会被长久的保存，不会因网页标签或浏览器窗口的关闭而消失，除非手动删除。点击 **读取本地存储** 按钮后，存储在本地的 *项目标题* 和 *黑名单列表* 数据会替换当前的项目标题和黑名单列表。

- **订单详情** : 点击 **添加订单详情** 按钮后，会添加下单日期时间、快递物流公司、快递物流单号信息。如果订单列表数据中的子订单编号、商品快照名称、商品快照链接有所缺失， **会使用订单详情中的数据进行补全** 。

- **添加本页订单** 和 **添加订单详情** 按钮颜色：常规状态为蓝色；订单添加进行中为橙色；订单添加完成后为绿色，单击订单区域或 **下一页** 后恢复为蓝色的常规状态。

## 注意事项

- 在导出订单之前 **不要刷新页面** ，刷新会导致已经添加的订单数据和设定的设置丢失！

- 在启用快照名称获取的情况下， 点击 **添加本页订单** 按钮后，此按钮会变为黄色，同时窗口右下角出现 *正在获取快照商品名称...* ，建议此时 **不要进行其它操作！** 。

- 黑名单关键字、图片链接尺寸选择和 Excel 数据格式适配等可选功能需要在添加订单之前设置。

- 建议在导入 CSV 文件到 Excel 时手动设置 **列数据格式** 为 **文本** 格式，以避免 *订单编号* 以科学计数法显示。

- 天猫超市中的商品快照名称和商品快照链接以及子订单编号，不支持通过 **添加本页订单** 来进行添加。但是可以通过 **添加订单详情** 来进行补全。

- 订单详情添加 **仅支持 3 个多月以内** 的订单详情数据。

## 声明

- 仅提取订单数据，数据储存于本地，不会被记录外泄。
